from calibre.web.feeds.news import BasicNewsRecipe
import re

class AdvancedUserRecipe(BasicNewsRecipe):

    title = 'heise online'
    description = 'News vom Heise-Verlag'
    __author__ = 'schuster'
    use_embedded_content   = False
    language = 'de'
    oldest_article = 2
    max_articles_per_feed = 35
    rescale_images = True
    remove_empty_feeds = True
    timeout = 5
    no_stylesheets = True
    encoding = 'utf-8'


    remove_tags_after = dict(name ='p', attrs={'class':'editor'})
    remove_tags = [{'class':'navi_top_container'},
                            dict(id='navi_bottom'),
                            dict(id='mitte_rechts'),
                            dict(id='navigation'),
                            dict(id='subnavi'),
                            dict(id='social_bookmarks'),
                            dict(id='permalink'),
                            dict(id='content_foren'),
                            dict(id='seiten_navi'),
                            dict(id='adbottom'),
                            dict(id='sitemap'),
                            dict(name='a', href=re.compile(r'^/([a-zA-Z]+/)?')),
                ]

    feeds =  [
                   ('Newsticker', 'http://www.heise.de/newsticker/heise.rdf'),
                   ('iX', 'http://www.heise.de/ix/news/news.rdf'),
                      ('Technology Review', 'http://www.heise.de/tr/news-atom.xml'),
                   ('mobil', 'http://www.heise.de/mobil/newsticker/heise-atom.xml'),
                   ('Security', 'http://www.heise.de/security/news/news-atom.xml'),
                   ('Netze', 'http://www.heise.de/netze/rss/netze-atom.xml'),
                   ('Open Source', 'http://www.heise.de/open/news/news-atom.xml'),
                   ('Resale ', 'http://www.heise.de/resale/rss/resale.rdf'),
                   ('Foto ', 'http://www.heise.de/foto/rss/news-atom.xml'),
                   ('Autos', 'http://www.heise.de/autos/rss/news.rdf'),
                   ('Mac & i', 'http://www.heise.de/mac-and-i/news.rdf'),
                   ('Blog: Babel-Bulletin', 'http://www.heise.de/developer/rss/babel-bulletin/blog.rdf'),
                   ('Blog: Der Dotnet-Doktor', 'http://www.heise.de/developer/rss/dotnet-doktor/blog.rdf'),
                   ('Blog: Bernds Management-Welt', 'http://www.heise.de/developer/rss/bernds-management-welt/blog.rdf'),
                   ('Blog: The World of IT', 'http://www.heise.de/developer/rss/world-of-it/blog.rdf'),
                   ('Blog: Kais bewegtes Web', 'http://www.heise.de/developer/rss/kais-bewegtes-web/blog.rdf')
             ]

    def print_version(self, url):
        return url + '?view=print'
