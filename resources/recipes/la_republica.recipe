#!/usr/bin/env  python
__license__   = 'GPL v3'
__author__    = 'Lorenzo Vigentini, based on Darko Miletic'
__copyright__ = '2009, Darko Miletic <darko.miletic at gmail.com>, Lorenzo Vigentini <l.vigentini at gmail.com>'
description   = 'Italian daily newspaper - v1.01 (04, January 2010)'

'''
http://www.repubblica.it/
'''

from calibre.web.feeds.news import BasicNewsRecipe

class LaRepublica(BasicNewsRecipe):
    author        = 'Lorenzo Vigentini, based on Darko Miletic'
    description   = 'Italian daily newspaper'

    cover_url      = 'http://www.repubblica.it/images/homepage/la_repubblica_logo.gif'
    title          = u'La Repubblica'
    publisher      = 'Gruppo editoriale L\'Espresso'
    category       = 'News, politics, culture, economy, general interest'

    language       = 'it'
    timefmt        = '[%a, %d %b, %Y]'

    oldest_article = 5
    max_articles_per_feed = 100
    use_embedded_content  = False
    recursion             = 10

    remove_javascript = True
    def get_article_url(self, article):
        link = article.get('id', article.get('guid', None))
        if link is None:
            return article
        return link

    keep_only_tags     = [dict(name='div', attrs={'class':'articolo'}),
                          dict(name='div', attrs={'class':'body-text'}),
                          dict(name='div', attrs={'class':'page-content'}),
                          dict(name='div', attrs={'id':'contA'})
                         ]


    remove_tags        = [
                            dict(name=['object','link']),
                            dict(name='span',attrs={'class':'linkindice'}),
                            dict(name='div', attrs={'class':'bottom-mobile'}),
                            dict(name='div', attrs={'id':['rssdiv','blocco']}),
                            dict(name='div', attrs={'class':'utility'}),
                            dict(name='div', attrs={'class':'generalbox'})
                         ]
    remove_tags_after = [
                            dict(name='div',attrs={'id':'ugc_linkUpload'})
                        ]

    feeds          = [
                       (u'Repubblica Rilievo', u'http://www.repubblica.it/rss/homepage/rss2.0.xml'),
                       (u'Repubblica Cronaca', u'http://www.repubblica.it/rss/cronaca/rss2.0.xml'),
                       (u'Repubblica Esteri', u'http://www.repubblica.it/rss/esteri/rss2.0.xml'),
                       (u'Repubblica Economia', u'http://www.repubblica.it/rss/economia/rss2.0.xml'),
                       (u'Repubblica Politica', u'http://www.repubblica.it/rss/politica/rss2.0.xml'),
                       (u'Repubblica Scienze', u'http://www.repubblica.it/rss/scienze/rss2.0.xml'),
                       (u'Repubblica Tecnologia', u'http://www.repubblica.it/rss/tecnologia/rss2.0.xml'),
                       (u'Repubblica Scuola e Universita', u'http://www.repubblica.it/rss/scuola_e_universita/rss2.0.xml'),
                       (u'Repubblica Ambiente', u'http://www.repubblica.it/rss/ambiente/rss2.0.xml'),
                       (u'Repubblica Cultura', u'http://www.repubblica.it/rss/spettacoli_e_cultura/rss2.0.xml'),
                       (u'Repubblica Persone', u'http://www.repubblica.it/rss/persone/rss2.0.xml'),
                       (u'Repubblica Sport', u'http://www.repubblica.it/rss/sport/rss2.0.xml'),
                       (u'Repubblica Calcio', u'http://www.repubblica.it/rss/sport/calcio/rss2.0.xml'),
                       (u'Repubblica Motori', u'http://www.repubblica.it/rss/motori/rss2.0.xml'),
                       (u'Repubblica Roma', u'http://roma.repubblica.it/rss/rss2.0.xml'),
                       (u'Repubblica Torino', u'http://torino.repubblica.it/rss/rss2.0.xml')
                      ]

